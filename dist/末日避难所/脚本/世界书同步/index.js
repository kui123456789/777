var __webpack_modules__ = {
  "./src/末日避难所/脚本/世界书同步/index.ts"() {
    eval("{\n/**\n * 世界书实时同步脚本\n * 从本地开发服务器加载 JSON 文件导入世界书到酒馆\n */\nconst WORLDBOOK_NAME = '末日避难所';\nconst WORLDBOOK_URL = 'http://localhost:5500/src/末日避难所/世界书/末日避难所.json';\nasync function importWorldbook() {\n    try {\n        console.info(`[世界书同步] 正在导入世界书: ${WORLDBOOK_NAME}...`);\n        // 从本地服务器加载世界书 JSON\n        const response = await fetch(WORLDBOOK_URL);\n        if (!response.ok) {\n            throw new Error(`加载世界书失败: ${response.status} ${response.statusText}`);\n        }\n        const worldbookData = await response.json();\n        const entryCount = Object.keys(worldbookData.entries || {}).length;\n        // 获取 SillyTavern 上下文\n        // 脚本在 iframe 中运行，需要通过 window.parent 访问主页面的 SillyTavern\n        // SillyTavern 对象只有 libs 和 getContext 两个属性，所有方法都在 getContext() 返回的对象上\n        const ctx = window.parent.SillyTavern.getContext();\n        // 使用 SillyTavern 的 saveWorldInfo API 保存世界书\n        // 保存世界书（immediately=true 立即保存）\n        await ctx.saveWorldInfo(WORLDBOOK_NAME, worldbookData, true);\n        // 刷新世界书列表\n        await ctx.updateWorldInfoList();\n        console.info(`[世界书同步] 世界书已同步，共 ${entryCount} 个条目`);\n        toastr.success(`世界书 \"${WORLDBOOK_NAME}\" 已同步 (${entryCount} 条目)`, '世界书同步');\n        return true;\n    }\n    catch (error) {\n        console.error(`[世界书同步] 同步失败:`, error);\n        toastr.error(`同步失败: ${error instanceof Error ? error.message : error}`, '世界书同步');\n        return false;\n    }\n}\n// 注册按钮事件：手动同步世界书\neventOn(getButtonEvent('同步世界书'), async () => {\n    await importWorldbook();\n});\n$(() => {\n    console.info(`[世界书同步] 脚本已加载`);\n    // 初始同步\n    importWorldbook();\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMv5pyr5pel6YG/6Zq+5omAL+iEmuacrC/kuJbnlYzkuablkIzmraUvaW5kZXgudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRztBQUVILE1BQU0sY0FBYyxHQUFHLE9BQU8sQ0FBQztBQUMvQixNQUFNLGFBQWEsR0FBRyxnREFBZ0QsQ0FBQztBQUV2RSxLQUFLLFVBQVUsZUFBZTtJQUM1QixJQUFJLENBQUM7UUFDSCxPQUFPLENBQUMsSUFBSSxDQUFDLG9CQUFvQixjQUFjLEtBQUssQ0FBQyxDQUFDO1FBRXRELG1CQUFtQjtRQUNuQixNQUFNLFFBQVEsR0FBRyxNQUFNLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUM1QyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQ2pCLE1BQU0sSUFBSSxLQUFLLENBQUMsWUFBWSxRQUFRLENBQUMsTUFBTSxJQUFJLFFBQVEsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDO1FBQ3hFLENBQUM7UUFFRCxNQUFNLGFBQWEsR0FBRyxNQUFNLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUM1QyxNQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDO1FBRW5FLHFCQUFxQjtRQUNyQix1REFBdUQ7UUFDdkQscUVBQXFFO1FBQ3JFLE1BQU0sR0FBRyxHQUFJLE1BQU0sQ0FBQyxNQUFjLENBQUMsV0FBVyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBRTVELDJDQUEyQztRQUMzQywrQkFBK0I7UUFDL0IsTUFBTSxHQUFHLENBQUMsYUFBYSxDQUFDLGNBQWMsRUFBRSxhQUFhLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFFN0QsVUFBVTtRQUNWLE1BQU0sR0FBRyxDQUFDLG1CQUFtQixFQUFFLENBQUM7UUFFaEMsT0FBTyxDQUFDLElBQUksQ0FBQyxvQkFBb0IsVUFBVSxNQUFNLENBQUMsQ0FBQztRQUNuRCxNQUFNLENBQUMsT0FBTyxDQUFDLFFBQVEsY0FBYyxVQUFVLFVBQVUsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBRTFFLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7UUFDZixPQUFPLENBQUMsS0FBSyxDQUFDLGVBQWUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN0QyxNQUFNLENBQUMsS0FBSyxDQUFDLFNBQVMsS0FBSyxZQUFZLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDakYsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0FBQ0gsQ0FBQztBQUVELGlCQUFpQjtBQUNqQixPQUFPLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEtBQUssSUFBSSxFQUFFO0lBQzFDLE1BQU0sZUFBZSxFQUFFLENBQUM7QUFDMUIsQ0FBQyxDQUFDLENBQUM7QUFFSCxDQUFDLENBQUMsR0FBRyxFQUFFO0lBQ0wsT0FBTyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUU5QixPQUFPO0lBQ1AsZUFBZSxFQUFFLENBQUM7QUFDcEIsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzIjpbInNyYzovL3RhdmVybl9oZWxwZXJfdGVtcGxhdGUvc3JjL+acq+aXpemBv+mavuaJgC/ohJrmnKwv5LiW55WM5Lmm5ZCM5q2lL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5LiW55WM5Lmm5a6e5pe25ZCM5q2l6ISa5pysXG4gKiDku47mnKzlnLDlvIDlj5HmnI3liqHlmajliqDovb0gSlNPTiDmlofku7blr7zlhaXkuJbnlYzkuabliLDphZLppoZcbiAqL1xuXG5jb25zdCBXT1JMREJPT0tfTkFNRSA9ICfmnKvml6Xpgb/pmr7miYAnO1xuY29uc3QgV09STERCT09LX1VSTCA9ICdodHRwOi8vbG9jYWxob3N0OjU1MDAvc3JjL+acq+aXpemBv+mavuaJgC/kuJbnlYzkuaYv5pyr5pel6YG/6Zq+5omALmpzb24nO1xuXG5hc3luYyBmdW5jdGlvbiBpbXBvcnRXb3JsZGJvb2soKSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5pbmZvKGBb5LiW55WM5Lmm5ZCM5q2lXSDmraPlnKjlr7zlhaXkuJbnlYzkuaY6ICR7V09STERCT09LX05BTUV9Li4uYCk7XG5cbiAgICAvLyDku47mnKzlnLDmnI3liqHlmajliqDovb3kuJbnlYzkuaYgSlNPTlxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goV09STERCT09LX1VSTCk7XG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGDliqDovb3kuJbnlYzkuablpLHotKU6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgfVxuXG4gICAgY29uc3Qgd29ybGRib29rRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICBjb25zdCBlbnRyeUNvdW50ID0gT2JqZWN0LmtleXMod29ybGRib29rRGF0YS5lbnRyaWVzIHx8IHt9KS5sZW5ndGg7XG5cbiAgICAvLyDojrflj5YgU2lsbHlUYXZlcm4g5LiK5LiL5paHXG4gICAgLy8g6ISa5pys5ZyoIGlmcmFtZSDkuK3ov5DooYzvvIzpnIDopoHpgJrov4cgd2luZG93LnBhcmVudCDorr/pl67kuLvpobXpnaLnmoQgU2lsbHlUYXZlcm5cbiAgICAvLyBTaWxseVRhdmVybiDlr7nosaHlj6rmnIkgbGlicyDlkowgZ2V0Q29udGV4dCDkuKTkuKrlsZ7mgKfvvIzmiYDmnInmlrnms5Xpg73lnKggZ2V0Q29udGV4dCgpIOi/lOWbnueahOWvueixoeS4ilxuICAgIGNvbnN0IGN0eCA9ICh3aW5kb3cucGFyZW50IGFzIGFueSkuU2lsbHlUYXZlcm4uZ2V0Q29udGV4dCgpO1xuXG4gICAgLy8g5L2/55SoIFNpbGx5VGF2ZXJuIOeahCBzYXZlV29ybGRJbmZvIEFQSSDkv53lrZjkuJbnlYzkuaZcbiAgICAvLyDkv53lrZjkuJbnlYzkuabvvIhpbW1lZGlhdGVseT10cnVlIOeri+WNs+S/neWtmO+8iVxuICAgIGF3YWl0IGN0eC5zYXZlV29ybGRJbmZvKFdPUkxEQk9PS19OQU1FLCB3b3JsZGJvb2tEYXRhLCB0cnVlKTtcblxuICAgIC8vIOWIt+aWsOS4lueVjOS5puWIl+ihqFxuICAgIGF3YWl0IGN0eC51cGRhdGVXb3JsZEluZm9MaXN0KCk7XG5cbiAgICBjb25zb2xlLmluZm8oYFvkuJbnlYzkuablkIzmraVdIOS4lueVjOS5puW3suWQjOatpe+8jOWFsSAke2VudHJ5Q291bnR9IOS4quadoeebrmApO1xuICAgIHRvYXN0ci5zdWNjZXNzKGDkuJbnlYzkuaYgXCIke1dPUkxEQk9PS19OQU1FfVwiIOW3suWQjOatpSAoJHtlbnRyeUNvdW50fSDmnaHnm64pYCwgJ+S4lueVjOS5puWQjOatpScpO1xuXG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihgW+S4lueVjOS5puWQjOatpV0g5ZCM5q2l5aSx6LSlOmAsIGVycm9yKTtcbiAgICB0b2FzdHIuZXJyb3IoYOWQjOatpeWksei0pTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IGVycm9yfWAsICfkuJbnlYzkuablkIzmraUnKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuLy8g5rOo5YaM5oyJ6ZKu5LqL5Lu277ya5omL5Yqo5ZCM5q2l5LiW55WM5LmmXG5ldmVudE9uKGdldEJ1dHRvbkV2ZW50KCflkIzmraXkuJbnlYzkuaYnKSwgYXN5bmMgKCkgPT4ge1xuICBhd2FpdCBpbXBvcnRXb3JsZGJvb2soKTtcbn0pO1xuXG4kKCgpID0+IHtcbiAgY29uc29sZS5pbmZvKGBb5LiW55WM5Lmm5ZCM5q2lXSDohJrmnKzlt7LliqDovb1gKTtcblxuICAvLyDliJ3lp4vlkIzmraVcbiAgaW1wb3J0V29ybGRib29rKCk7XG59KTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/末日避难所/脚本/世界书同步/index.ts\n\n}");
  }
};

var __webpack_exports__ = {};

__webpack_modules__["./src/末日避难所/脚本/世界书同步/index.ts"]();