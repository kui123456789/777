{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/末日避难所/schema.ts","src://tavern_helper_template/src/末日避难所/脚本/变量结构/index.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = z;","// 末日避难所管理类角色卡 - MVU 变量结构定义\n// ===== 一、世界环境层 =====\nconst 灾难类型枚举 = z.enum(['核战', '丧尸潮', '极寒', '伪人入侵', '病毒爆发', '机器暴动', '外星入侵', '超自然灾变']);\nconst 时间线节点枚举 = z.enum([\n    '爆发前的一周',\n    '爆发前的五分钟',\n    '爆发后的一年',\n    '爆发的十年后',\n    '爆发的一百年后',\n    '爆发的两百年后',\n]);\nconst 世界环境层 = z.object({\n    当前日期: z.string().prefault('2077年10月23日'),\n    当前时间: z.string().prefault('08:00'),\n    灾难本质: 灾难类型枚举.prefault('核战'),\n    世界现状: z.string().prefault('高辐射环境，地表废土化'),\n    时间线节点: 时间线节点枚举.prefault('爆发后的一年'),\n});\n// ===== 二、避难所状态层 =====\nconst 资源状态 = z.object({\n    当前值: z.coerce\n        .number()\n        .transform(v => Math.max(0, v))\n        .prefault(50),\n    上限: z.coerce\n        .number()\n        .transform(v => Math.max(1, v))\n        .prefault(100),\n});\nconst 基础生存资源 = z.object({\n    电力: 资源状态.prefault({ 当前值: 50, 上限: 100 }),\n    水源: 资源状态.prefault({ 当前值: 50, 上限: 100 }),\n    食物: 资源状态.prefault({ 当前值: 50, 上限: 100 }),\n    人口: 资源状态.prefault({ 当前值: 30, 上限: 100 }),\n});\nconst 环境指标 = z.object({\n    科技等级: z.string().prefault('工业时代'),\n    卫生度: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(60),\n    精神健康度: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(50),\n});\n// 社会制度滑块 (0-100, 50为中间值)\nconst 社会制度 = z.object({\n    分配方法: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(50), // 0=公平, 100=效率\n    信息管控: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(50), // 0=言论自由, 100=统一思想\n    社会伦理: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(50), // 0=人性, 100=生存\n    治安手段: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(50), // 0=重教化, 100=重刑罚\n});\nconst 宏观属性 = z.object({\n    统治力: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(50),\n    防御等级: z.coerce\n        .number()\n        .transform(v => Math.max(0, v))\n        .prefault(10),\n    隐蔽度: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(50),\n    隐藏目的: z.string().prefault('无'),\n    秘密实验进度: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(0),\n});\nconst 避难所状态层 = z.object({\n    避难所名称: z.string().prefault('Vault-101'),\n    基础生存资源: 基础生存资源.prefault({\n        电力: { 当前值: 50, 上限: 100 },\n        水源: { 当前值: 50, 上限: 100 },\n        食物: { 当前值: 50, 上限: 100 },\n        人口: { 当前值: 30, 上限: 100 },\n    }),\n    环境指标: 环境指标.prefault({\n        科技等级: '工业时代',\n        卫生度: 60,\n        精神健康度: 50,\n    }),\n    社会制度: 社会制度.prefault({\n        分配方法: 50,\n        信息管控: 50,\n        社会伦理: 50,\n        治安手段: 50,\n    }),\n    宏观属性: 宏观属性.prefault({\n        统治力: 50,\n        防御等级: 10,\n        隐蔽度: 50,\n        隐藏目的: '无',\n        秘密实验进度: 0,\n    }),\n});\n// ===== 三、社会关系与派系 =====\nconst 派系信息 = z.object({\n    宗旨: z.string().prefault('待定'),\n    好感度: z.coerce\n        .number()\n        .transform(v => _.clamp(v, -100, 100))\n        .prefault(0),\n    观感: z.string().prefault('中立'),\n    领导人: z.string().prefault('未知'),\n    人数占比: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(10),\n});\nconst 社会关系与派系 = z.record(z.string().describe('派系名称'), 派系信息.prefault({\n    宗旨: '待定',\n    好感度: 0,\n    观感: '中立',\n    领导人: '未知',\n    人数占比: 10,\n}));\n// ===== 四、设施与库存 =====\nconst 设施信息 = z.object({\n    等级: z.coerce\n        .number()\n        .transform(v => Math.max(1, v))\n        .prefault(1),\n    效果: z.string().prefault('基础功能'),\n    说明: z.string().prefault(''),\n    状态: z.enum(['正常', '损坏', '升级中', '停用']).prefault('正常'),\n});\nconst 物品信息 = z.object({\n    类型: z.enum(['武器', '防具', '饰品', '消耗品', '材料', '杂项']).prefault('杂项'),\n    效果: z.string().prefault(''),\n    说明: z.string().prefault(''),\n    数量: z.coerce\n        .number()\n        .transform(v => Math.max(0, v))\n        .prefault(1),\n});\nconst 设施与库存 = z.object({\n    设施区域: z\n        .record(z.string().describe('设施名称'), 设施信息.prefault({\n        等级: 1,\n        效果: '基础功能',\n        说明: '',\n        状态: '正常',\n    }))\n        .prefault({}),\n    仓库系统: z\n        .record(z.string().describe('物品名称'), 物品信息.prefault({\n        类型: '杂项',\n        效果: '',\n        说明: '',\n        数量: 1,\n    }))\n        .transform(data => _.pickBy(data, ({ 数量 }) => 数量 > 0))\n        .prefault({}),\n});\n// ===== 五、监督者系统 =====\nconst SPECIAL属性 = z.object({\n    威慑力: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 1, 10))\n        .prefault(5), // S\n    洞察力: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 1, 10))\n        .prefault(5), // P\n    抗压值: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 1, 10))\n        .prefault(5), // E\n    统御力: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 1, 10))\n        .prefault(5), // C\n    科研力: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 1, 10))\n        .prefault(5), // I\n    反应力: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 1, 10))\n        .prefault(5), // A\n    气运: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 1, 10))\n        .prefault(5), // L\n});\nconst 特质信息 = z.object({\n    效果: z.string().prefault(''),\n});\nconst 监督者系统 = z.object({\n    姓名: z.string().prefault('{{user}}'),\n    当前位置: z.string().prefault('监督者办公室'),\n    行动点数: z.coerce\n        .number()\n        .transform(v => Math.max(0, v))\n        .prefault(3),\n    行动点数上限: z.coerce\n        .number()\n        .transform(v => Math.max(1, v))\n        .prefault(3),\n    SPECIAL: SPECIAL属性.prefault({\n        威慑力: 5,\n        洞察力: 5,\n        抗压值: 5,\n        统御力: 5,\n        科研力: 5,\n        反应力: 5,\n        气运: 5,\n    }),\n    特质: z.record(z.string().describe('特质名称'), 特质信息.prefault({ 效果: '' })).prefault({}),\n});\n// ===== 六、追随者系统 =====\nconst 装备栏 = z.object({\n    武器位: z.string().prefault('空'),\n    防具位: z.string().prefault('空'),\n    饰品工具位: z.string().prefault('空'),\n});\nconst 追随者信息 = z.object({\n    姓名: z.string().prefault('未命名'),\n    年龄: z.coerce\n        .number()\n        .transform(v => Math.max(0, v))\n        .prefault(25),\n    性别: z.enum(['男', '女', '其他']).prefault('男'),\n    // 核心数值\n    武力: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 1, 100))\n        .prefault(10),\n    管理: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 1, 100))\n        .prefault(10),\n    探索生存: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 1, 100))\n        .prefault(10),\n    // 生存状态\n    生命值: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(100),\n    防护等级: z.coerce\n        .number()\n        .transform(v => Math.max(0, v))\n        .prefault(0),\n    状态: z.enum(['健康', '生病', '崩溃', '死亡']).prefault('健康'),\n    忠诚度: z.coerce\n        .number()\n        .transform(v => _.clamp(v, 0, 100))\n        .prefault(50),\n    // 装备栏\n    装备栏: 装备栏.prefault({\n        武器位: '空',\n        防具位: '空',\n        饰品工具位: '空',\n    }),\n    // 特质\n    特质: z.record(z.string().describe('特质名称'), 特质信息.prefault({ 效果: '' })).prefault({}),\n    // 描述\n    描述: z.string().prefault(''),\n});\nconst 追随者系统 = z.record(z.string().describe('追随者ID'), 追随者信息.prefault({\n    姓名: '未命名',\n    年龄: 25,\n    性别: '男',\n    武力: 10,\n    管理: 10,\n    探索生存: 10,\n    生命值: 100,\n    防护等级: 0,\n    状态: '健康',\n    忠诚度: 50,\n    装备栏: { 武器位: '空', 防具位: '空', 饰品工具位: '空' },\n    特质: {},\n    描述: '',\n}));\n// ===== 综合 Schema (基础版本，用于 store) =====\nexport const Schema = z.object({\n    世界: 世界环境层.prefault({\n        当前日期: '2077年10月23日',\n        当前时间: '08:00',\n        灾难本质: '核战',\n        世界现状: '高辐射环境，地表废土化',\n        时间线节点: '爆发后的一年',\n    }),\n    避难所: 避难所状态层.prefault({\n        避难所名称: 'Vault-101',\n        基础生存资源: {\n            电力: { 当前值: 50, 上限: 100 },\n            水源: { 当前值: 50, 上限: 100 },\n            食物: { 当前值: 50, 上限: 100 },\n            人口: { 当前值: 30, 上限: 100 },\n        },\n        环境指标: { 科技等级: '工业时代', 卫生度: 60, 精神健康度: 50 },\n        社会制度: { 分配方法: 50, 信息管控: 50, 社会伦理: 50, 治安手段: 50 },\n        宏观属性: { 统治力: 50, 防御等级: 10, 隐蔽度: 50, 隐藏目的: '无', 秘密实验进度: 0 },\n    }),\n    派系: 社会关系与派系.prefault({}),\n    设施与库存: 设施与库存.prefault({\n        设施区域: {},\n        仓库系统: {},\n    }),\n    监督者: 监督者系统.prefault({\n        姓名: '{{user}}',\n        当前位置: '监督者办公室',\n        行动点数: 3,\n        行动点数上限: 3,\n        SPECIAL: { 威慑力: 5, 洞察力: 5, 抗压值: 5, 统御力: 5, 科研力: 5, 反应力: 5, 气运: 5 },\n        特质: {},\n    }),\n    追随者: 追随者系统.prefault({}),\n    // 派生属性 (由 transform 计算，但为了兼容 store 直接放在这里)\n    $社会Buff: z.array(z.string()).prefault([]),\n    $资源警告: z.array(z.string()).prefault([]),\n    $气运加成: z.coerce.number().prefault(0),\n});\n// ===== 辅助函数：计算派生属性 =====\nexport function computeDerivedProperties(data) {\n    const 避难所 = data.避难所;\n    // 根据信息管控极端值触发 Buff\n    const $社会Buff = [];\n    if (避难所.社会制度.信息管控 >= 95) {\n        $社会Buff.push('蜂巢思维');\n    }\n    if (避难所.社会制度.社会伦理 >= 95) {\n        $社会Buff.push('冷酷生存');\n    }\n    if (避难所.社会制度.社会伦理 <= 5) {\n        $社会Buff.push('理想主义');\n    }\n    if (避难所.社会制度.治安手段 >= 95) {\n        $社会Buff.push('铁腕统治');\n    }\n    // 计算资源紧缺警告\n    const $资源警告 = [];\n    const 资源 = 避难所.基础生存资源;\n    if (资源.电力.当前值 / 资源.电力.上限 < 0.2)\n        $资源警告.push('电力紧缺');\n    if (资源.水源.当前值 / 资源.水源.上限 < 0.2)\n        $资源警告.push('水源紧缺');\n    if (资源.食物.当前值 / 资源.食物.上限 < 0.2)\n        $资源警告.push('食物紧缺');\n    // 计算L属性加成\n    const $气运加成 = Math.floor(data.监督者.SPECIAL.气运 * 0.33);\n    return {\n        ...data,\n        $社会Buff,\n        $资源警告,\n        $气运加成,\n    };\n}\n","import { registerMvuSchema } from 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js';\nimport { Schema } from '../../schema';\n\n$(() => {\n  registerMvuSchema(Schema);\n});\n"],"names":["z","enum","object","string","prefault","coerce","number","transform","v","Math","max","_","clamp","record","describe","data","pickBy","SPECIAL","Schema","array","$"],"ignoreList":[],"sourceRoot":""}